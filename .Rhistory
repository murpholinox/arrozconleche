ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide)
ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + theme(axis.text.x = element_text(angle = 90)) + coord_flip()
ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
set1 <-c("P00918", "P11838", "P00698", "P00760", "Q6PJP8", "Q6B0I6", "P02766", "O95696", "Q9UIF8", "P00644")
#P00720 P24941 P42212 P29476 P02185 O60885 P18031 P61823 P07900 P28720
#P61626 P15121 P56817 P0DTD1 P19491 P23497 P00800 O26232 P22629 P00489
#P03367 P68400 A0A073FPA6 P46881 Q16539 P00811 P14174 P00431 P01116 P00183
#P01112 Q00511 Q76353 P00282 P02883 P02945 P06873 P16113 Q04609 P00772
mkplt1 <- by_idegpo %>%
filter(ide %in% set1)
View(mkplt1)
set1 <-c("P00918", "P11838", "P00698", "P00760", "Q6PJP8", "Q6B0I6", "P02766", "O95696", "Q9UIF8", "P00644")
set2 <-c("P00720", "P24941", "P42212", "P29476", "P02185", "O60885", "P18031", "P61823", "P07900", "P28720")
set3 <-c("P61626", "P15121", "P56817", "P0DTD1", "P19491", "P23497", "P00800", "O26232", "P22629", "P00489")
set4 <-c("P03367", "P68400", "A0A073FPA6", "P46881", "Q16539", "P00811", "P14174", "P00431", "P01116", "P00183")
set5 <-c("P01112", "Q00511", "Q76353", "P00282", "P02883", "P02945", "P06873", "P16113", "Q04609", "P00772")
mkplt1 <- by_idegpo %>%
filter(ide %in% set1)
mkplt2 <- by_idegpo %>%
filter(ide %in% set2)
mkplt3 <- by_idegpo %>%
filter(ide %in% set3)
mkplt4 <- by_idegpo %>%
filter(ide %in% set4)
mkplt5 <- by_idegpo %>%
filter(ide %in% set5)
ggplot(data = mkplt1, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt1, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt2, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt3, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt5, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo Espacial")
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + + scale_x_discrete(limits=c("4","5","6", "7", "8", "9", "10"))
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_x_discrete(limits=c("4","5","6", "7", "8", "9", "10"))
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + + scale_y_continuous(breaks=c(5,6,7,8,9,10))
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=c(5,6,7,8,9,10))
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:11))
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12))
ggplot(data = mkplt2, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12))
ggplot(data = mkplt2, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + xlab("pH") + ylab("Grupo Espacial")
ggplot(data = mkplt2, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo Espacial")
# Final
setwd("/run/media/murphy/lolita/doctorado/clean/fil5")
# ggplot(data = fil4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = by_idegpo, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = fil4, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# Las gráficas por partes están más decentes.
# Histogramas
ggplot(data = mkplt1, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_1.svg", width = 20, units = "cm")
library(tidyverse)
library(knitr)
library(kableExtra)
library(stringdist)
library(svglite)
install.packages("svglite")
library(tidyverse)
library(knitr)
library(kableExtra)
library(stringdist)
library(svglite)
# Final
setwd("/run/media/murphy/lolita/doctorado/clean/fil5")
# ggplot(data = fil4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = by_idegpo, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = fil4, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# Las gráficas por partes están más decentes.
# Histogramas
ggplot(data = mkplt1, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_1.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_1.png", width = 20, units = "cm")
ggplot(data = mkplt2, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_2.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_2.png", width = 20, units = "cm")
ggplot(data = mkplt3, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_3.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_3.png", width = 20, units = "cm")
ggplot(data = mkplt4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_4.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_4.png", width = 20, units = "cm")
ggplot(data = mkplt5, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_5.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_hist_5.png", width = 20, units = "cm")
# Boxplots
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_1.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_1.png", width = 20, units = "cm")
ggplot(data = mkplt2, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_2.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_2.png", width = 20, units = "cm")
ggplot(data = mkplt3, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_3.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_3.png", width = 20, units = "cm")
ggplot(data = mkplt4, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_4.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_4.png", width = 20, units = "cm")
ggplot(data = mkplt5, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_5.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/final_bp_5.png", width = 20, units = "cm")
# Falta eliminar las entradas que no nos sirven y hacer la gráfica final
malas <-c("P02945", "Q04609", "Q76353", "AOAO73FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6BOI6", "Q6PJP8", "Q9UIF8", "P18031", "P29476")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
malas <-c("P02945", "Q04609", "Q76353", "AOAO73FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6BOI6", "Q6PJP8", "Q9UIF8", "P18031", "P29476")
buenas <- by_idegpo %>%
filter(!(ide %in% malas))
library(tidyverse)
library(knitr)
library(kableExtra)
library(stringdist)
library(svglite)
todo2 <- read_delim("/run/media/murphy/lolita/doctorado/extract/todo2",
"¿", escape_double = FALSE, col_names = FALSE,
comment = "*>", trim_ws = TRUE)
# La configuración regional de mi sistema está en inglés, `R` también por lo que no reconoce '¿'.
pdb<-todo2$X1
nde<-stringr::str_replace(todo2$X2, '�', '')
tde<-stringr::str_replace(todo2$X3, '�', '')
ide<-stringr::str_replace(todo2$X4, '�', '')
nom<-stringr::str_replace(todo2$X5, '�', '')
tec<-stringr::str_replace(todo2$X6, '�', '')
peh<-stringr::str_replace(todo2$X7, '�', '')
con<-stringr::str_replace(todo2$X8, '�', '')
rs1<-stringr::str_replace(todo2$X9, '�', '')
rs2<-stringr::str_replace(todo2$X10, '�', '')
gpo<-stringr::str_replace(todo2$X11, '�', '')
doi<-stringr::str_replace(todo2$X12, '�', '')
datos<-data.frame(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)
rm(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)
# Cuidado con el tipo de las columnas.
datos$nde<-as.numeric(as.character((datos$nde)))
datos$peh<-as.numeric(as.character((datos$peh)))
datos$rs1<-as.numeric(as.character((datos$rs1)))
datos$rs2<-as.numeric(as.character((datos$rs2)))
# Verificamos los datos al graficar algunas variables interesantes:
theme_set(theme_bw())
# Histograma del pH.
ggplot(data = datos, aes(x=peh)) + geom_histogram(binwidth = 0.5) + labs(x="pH", y="Frecuencia") + xlim(1, 11)
# Histograma de la resolución.
ggplot(data = datos, aes(x=rs1)) + geom_histogram(binwidth = 0.1) + labs(x="Resolución (Å)", y="Frecuencia")
# Histograma del número de entidades.
ggplot(data = datos, aes(x=nde)) + geom_histogram(binwidth = 1) + labs(x="Número de entidades", y="Frecuencia")
# Determina cuentas por grupo de grupos espaciales y tido de entidad.
df1<-datos %>%
add_count(gpo, name = "cta_gpo")
df2<-df1 %>%
add_count(tde, name = "cta_tde")
tab_gpo<-datos %>%
count(gpo, name = "cta_gpo") %>%
arrange(desc(cta_gpo))
tab_tde<-datos %>%
count(tde, name = "cta_tde") %>%
arrange(desc(cta_tde))
# Gráfico de barras de los grupos espaciales.
ggplot(data = df1, aes(x=reorder(gpo, cta_gpo))) + geom_bar() + labs(x="Grupo espacial", y="Frecuencia") + theme(axis.text.x = element_text(angle = 90))
# Es interesante notar que el número de grupos espaciales es mayor a 65.
gpo_rar <- df2 %>%
filter(cta_gpo <= 15)
# Gráfico de barras de los grupos espaciales menos comunes.
ggplot(data = gpo_rar, aes(x=reorder(gpo, cta_gpo))) + geom_bar() + labs(x="Grupo espacial", y="Frecuencia", title = "Grupos espaciales con una frecuencia menor o igual a 15") + coord_flip()#+ theme(axis.text.x = element_text(size = 12, angle = 45))
# Genera tablas.
# Tabla de grupos espaciales en el PDB.
kable(tab_gpo) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
# Tabla del tipo de entidades en el PDB.
kable(tab_tde) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
rm(todo2, df1, datos)
# Guarda datos como `.csv`.
write_excel_csv(df2, "/run/media/murphy/lolita/doctorado/extract/df2.csv")
# Filtro 0
fil0 <-df2 %>%
filter(!ide =="") # Si no tiene identificador se va.
# Filtro 1
fil1 <- fil0 %>%
filter(rs1 <= 2.0) # Mala resolución no me sirve.
# Filtro 2
fil2 <-fil1 %>%
filter(!is.na(peh)) # Si no tiene pH se va.
write_excel_csv(fil2, "/run/media/murphy/lolita/doctorado/clean/fil2.csv")
# wc -l fil2.csv
# 69669 fil2.csv
# Carga fil3.
fil3 <- read_csv("/run/media/murphy/lolita/doctorado/clean/fil3.csv")
fil3cola <- fil3 %>%
count(ide, name="cta_ide") %>% # Colapsa los datos hacia n
arrange(desc(cta_ide))
fil3nocola <- fil3 %>% # Agrega n
add_count(ide, name="cta_ide") %>%
arrange(desc(cta_ide))
# Una tabla
tab_fil3cola<-head(fil3cola, n=50) #Aquí escoge n.
kable(tab_fil3cola) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
write_excel_csv(tab_fil3cola, "/run/media/murphy/lolita/doctorado/clean/tab_fil3cola.csv")
ide_in_tf3c <- tab_fil3cola$ide
for (j in seq(1,50))
{
ide_i_ <-ide_in_tf3c[[j]]
filename <- paste("/run/media/murphy/lolita/doctorado/clean/fil4/dir/", ide_i_, sep="") #
write_excel_csv(filter(fil3, ide==ide_i_), filename)
}
for (j in seq(1,50))
{
ide <-ide_in_tf3c[[j]] # identificador
file1 <- paste("/run/media/murphy/lolita/doctorado/clean/fil4/dir/can_seq_", ide, ".csv", sep="")
impo1 <- read_delim(file1, "¿", escape_double = FALSE, col_names = FALSE,
comment = "*>", trim_ws = TRUE)
pdb<-impo1$X1
nde<-stringr::str_replace(impo1$X2, '�', '')
tde<-stringr::str_replace(impo1$X3, '�', '')
sec0<-stringr::str_replace(impo1$X4, '�', '')
sec<-stringr::str_replace_all(sec0, '\\\\n', '')
oname1 = paste("df", "_", ide, sep="")
assign(oname1, data.frame(pdb, nde, tde, sec))
file2 <- paste("/run/media/murphy/lolita/doctorado/clean/fil4/dir/cons_", ide, "_c", sep="")
impo2 <- read_csv(file2, col_names = FALSE)
oname2 = paste("cons_", ide, sep="")
assign(oname2, impo2$X1)
n<-nrow(get(oname1))
bad_seq<-c() # Vacío
for(i in seq(1, n)) {
y <- adist(get(oname1)$sec[i], get(oname2))
if(y >= 15)
{bad_seq <- c(bad_seq, "NotWt")}
else
{bad_seq <- c(bad_seq, "Wt")}
}
assign(oname1, cbind(get(oname1), bad_seq))
file3 <-paste("/run/media/murphy/lolita/doctorado/clean/fil4/dir/fil4_", ide, sep="")
write_excel_csv(get(oname1), file3)
}
setwd("/run/media/murphy/lolita/doctorado/clean/fil4/dir")
#bad_pdbs <- read_table2("/run/media/murphy/lolita/doctorado/clean/fil4/dir/bad_pdbs", col_names = FALSE)
casifil4 <- read_delim("/run/media/murphy/lolita/doctorado/clean/fil4/dir/casifil4", "¿", escape_double = FALSE, col_names = FALSE, comment = "*>", trim_ws = TRUE)
casifil4_2 <- read_csv("/run/media/murphy/lolita/doctorado/clean/fil4/dir/casifil4_2",
col_names = FALSE)
casifil4_2<-rename(casifil4_2, bad=X5)
allbadseqs <-select(casifil4_2, bad)
ym_fil4<-cbind(casifil4, allbadseqs)
pdb<-ym_fil4$X1
nde<-stringr::str_replace(ym_fil4$X2, '�', '')
tde<-stringr::str_replace(ym_fil4$X3, '�', '')
ide<-stringr::str_replace(ym_fil4$X4, '�', '')
nom<-stringr::str_replace(ym_fil4$X5, '�', '')
tec<-stringr::str_replace(ym_fil4$X6, '�', '')
peh<-stringr::str_replace(ym_fil4$X7, '�', '')
con<-stringr::str_replace(ym_fil4$X8, '�', '')
rs1<-stringr::str_replace(ym_fil4$X9, '�', '')
rs2<-stringr::str_replace(ym_fil4$X10, '�', '')
gpo<-stringr::str_replace(ym_fil4$X11, '�', '')
doi<-stringr::str_replace(ym_fil4$X12, '�', '')
sil<-ym_fil4$bad
ymto_fil4<-tibble(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi, sil)
rm(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi, sil)
# Cuidado con el tipo de las columnas, de nuevo
ymto_fil4$nde<-as.numeric(as.character((ymto_fil4$nde)))
ymto_fil4$peh<-as.numeric(as.character((ymto_fil4$peh)))
ymto_fil4$rs1<-as.numeric(as.character((ymto_fil4$rs1)))
ymto_fil4$rs2<-as.numeric(as.character((ymto_fil4$rs2)))
fil4<- ymto_fil4 %>%
filter(sil=="Wt") # Las secuencias malas son 666. casifil* tienen 7719 obs.
# fil4 tiene 7719-666=7053
setwd("/run/media/murphy/lolita/doctorado/clean/fil4/plots_all")
for (j in seq(1,50))
{
id <-tab_fil3cola$ide[j]
ggplot(filter(fil4, ide==id), aes(x=peh)) + geom_histogram(binwidth = 0.5) + facet_wrap( ~ gpo) + xlab("pH") + ylab ("Número de entradas") + coord_cartesian(ylim = c(1, 20)) + geom_hline(yintercept=5, linetype="dashed", color = "#999999")
pdfplot<-paste("hist_pH_wrap_gpo_", id, ".pdf", sep="" )
pngplot<-paste("hist_pH_wrap_gpo_", id, ".png", sep="" )
ggsave(pdfplot, width = 20, units = "cm")
ggsave(pngplot, width = 20, units = "cm")
}
# Toma solo aquellas entradas donde n sea mayor a 10
by_idegpo <-fil4 %>%
add_count(ide, gpo) %>%
arrange(ide, desc(n)) %>%
filter(n>10)
setwd("/run/media/murphy/lolita/doctorado/clean/fil4/plots_gt10")
for (j in seq(1,50))
{
id <-tab_fil3cola$ide[j]
ggplot(filter(by_idegpo, ide==id), aes(x=peh)) + geom_histogram(binwidth = 0.5) + facet_wrap( ~ gpo) + xlab("pH") + ylab ("Número de entradas") + coord_cartesian(ylim = c(1, 20)) + geom_hline(yintercept=5, linetype="dashed", color = "#999999")
pdfplot<-paste("hist_pH_wrap_gpo_", id, ".pdf", sep="" )
pngplot<-paste("hist_pH_wrap_gpo_", id, ".png", sep="" )
ggsave(pdfplot, width = 20, units = "cm")
ggsave(pngplot, width = 20, units = "cm")
}
set1 <-c("P00918", "P11838", "P00698", "P00760", "Q6PJP8", "Q6B0I6", "P02766", "O95696", "Q9UIF8", "P00644")
set2 <-c("P00720", "P24941", "P42212", "P29476", "P02185", "O60885", "P18031", "P61823", "P07900", "P28720")
set3 <-c("P61626", "P15121", "P56817", "P0DTD1", "P19491", "P23497", "P00800", "O26232", "P22629", "P00489")
set4 <-c("P03367", "P68400", "A0A073FPA6", "P46881", "Q16539", "P00811", "P14174", "P00431", "P01116", "P00183")
set5 <-c("P01112", "Q00511", "Q76353", "P00282", "P02883", "P02945", "P06873", "P16113", "Q04609", "P00772")
mkplt1 <- by_idegpo %>%
filter(ide %in% set1)
mkplt2 <- by_idegpo %>%
filter(ide %in% set2)
mkplt3 <- by_idegpo %>%
filter(ide %in% set3)
mkplt4 <- by_idegpo %>%
filter(ide %in% set4)
mkplt5 <- by_idegpo %>%
filter(ide %in% set5)
# Semi-Final
setwd("/run/media/murphy/lolita/doctorado/clean/fil5")
# ggplot(data = fil4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = by_idegpo, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
# ggplot(data = fil4, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# ggplot(data = by_idegpo, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip()
# Las gráficas por partes están más decentes.
# Histogramas
ggplot(data = mkplt1, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_1.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_1.png", width = 20, units = "cm")
ggplot(data = mkplt2, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_2.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_2.png", width = 20, units = "cm")
ggplot(data = mkplt3, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_3.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_3.png", width = 20, units = "cm")
ggplot(data = mkplt4, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_4.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_4.png", width = 20, units = "cm")
ggplot(data = mkplt5, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_5.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_hist_5.png", width = 20, units = "cm")
# Boxplots
ggplot(data = mkplt1, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_1.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_1.png", width = 20, units = "cm")
ggplot(data = mkplt2, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_2.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_2.png", width = 20, units = "cm")
ggplot(data = mkplt3, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_3.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_3.png", width = 20, units = "cm")
ggplot(data = mkplt4, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_4.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_4.png", width = 20, units = "cm")
ggplot(data = mkplt5, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_5.svg", width = 20, units = "cm")
ggsave("/run/media/murphy/lolita/doctorado/clean/fil5/plots/final_bp_5.png", width = 20, units = "cm")
malas <-c("P02945", "Q04609", "Q76353", "AOAO73FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6BOI6", "Q6PJP8", "Q9UIF8", "P18031", "P29476")
buenas <- by_idegpo %>%
filter(!(ide %in% malas))
View(buenas)
View(by_idegpo)
View(by_idegpo)
malas <-c("P02945", "Q04609", "Q76353", "AOAO73FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6BOI6", "Q6PJP8", "Q9UIF8", "P18031", "P29476")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
View(buenas)
View(buenas)
ggplot(data = buenas, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black", alpha=0.5) + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
ggplot(data = buenas, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color="black", alpha=0.5) + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
rebuenas <-buenas %>%
add_count(ide, gpo) %>%
arrange(ide, desc(n))# %>%
#filter(n>10)
View(rebuenas)
View(rebuenas)
arrange(buenas, ide, desc(n))
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
buenas %>%
arrange(ide, desc(n))
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
buenas %>%
by_count(ide, gpo)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
buenas %>%
count(ide, gpo)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
tab_bue <-buenas %>%
count(ide, gpo) %>%
kable(tab_bue) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
tab_bue <-buenas %>%
count(ide, gpo)
kable(tab_bue) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
tab_bue <-buenas %>%
count(ide, gpo) %>%
arrange(desc(n))
kable(tab_bue) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
# Toma solo aquellas entradas donde n sea mayor a 10
tab_bue <-buenas %>%
arrange(desc(n))
kable(tab_bue) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas)
arrange(desc(n))
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- by_idegpo %>%
filter(!ide %in% malas) %>%
arrange(desc(n))
# Toma solo aquellas entradas donde n sea mayor a 10
kable(buenas) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas <- fil4 %>%
filter(!ide %in% malas) %>%
count(ide, gpo) %>%
arrange(desc(n))
# Tabla
kable(buenas) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
ggplot(data = buenas, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggplot(data = buenas_nocola, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas_cola <- fil4 %>%
filter(!ide %in% malas) %>%
count(ide, gpo) %>%
arrange(desc(n))
buenas_nocola <- fil4 %>%
filter(!ide %in% malas) %>%
add_count(ide, gpo) %>%
arrange(desc(n))
# Tabla
kable(buenas_cola) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
ggplot(data = buenas_nocola, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggplot(data = buenas_nocola, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggplot(data = buenas_nocola, aes(x=factor(gpo), y=peh)) + geom_boxplot() + facet_wrap(~ ide) + coord_flip() + scale_y_continuous(breaks=seq(3:12)) + ylab("pH") + xlab("Grupo espacial")
ggplot(data = buenas_nocola, aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggplot(data = buenas_nocola %>% filter(ide=="O26232"), aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ ide) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
ggplot(data = buenas_nocola %>% filter(ide=="O26232"), aes(x=peh, fill=gpo)) + geom_histogram(binwidth = 0.5, color ="black") + coord_cartesian(ylim = c(1, 10)) + facet_wrap(~ gpo) + xlab("pH") + ylab ("Número de entradas") + scale_fill_discrete(name="Grupo espacial")
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas_cola <- fil4 %>%
filter(!ide %in% malas) %>%
filter(n>10) %>%
count(ide, gpo) %>%
arrange(desc(n))
buenas_nocola <- fil4 %>%
filter(!ide %in% malas) %>%
filter(n>10) %>%
add_count(ide, gpo) %>%
arrange(desc(n))
# Tabla
kable(buenas_cola) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
View(buenas_cola)
View(buenas_cola)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas_cola <- fil4 %>%
filter(!ide %in% malas) %>%
filter(n>10) %>%
count(ide, gpo) %>%
arrange(desc(n))
buenas_nocola <- fil4 %>%
filter(!ide %in% malas) %>%
filter(n>10) %>%
add_count(ide, gpo) %>%
arrange(desc(n))
# Tabla
kable(buenas_cola) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
View(buenas_nocola)
View(buenas_nocola)
malas <-c("P02945", "Q04609", "Q76353", "A0A073FPA6", "P00811", "P46881", "P00489", "P23497", "O95696", "P11838", "Q6B0I6", "Q6PJP8", "Q9UIF8", "P18031", "P29476", "P28720")
buenas_cola <- fil4 %>%
filter(!ide %in% malas) %>%
filter(n >= 10) %>%
count(ide, gpo) %>%
arrange(desc(n))
buenas_nocola <- fil4 %>%
filter(!ide %in% malas) %>%
filter( n>= 10) %>%
add_count(ide, gpo) %>%
arrange(desc(n))
# Tabla
kable(buenas_cola) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width=F)
