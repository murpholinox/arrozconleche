<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bitácora</title>
  <meta name="description" content="Bitácora de doctorado" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Bitácora" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Bitácora de doctorado" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bitácora" />
  
  <meta name="twitter:description" content="Bitácora de doctorado" />
  

<meta name="author" content="Francisco Murphy Pérez" />


<meta name="date" content="2020-06-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dependencias.html"/>
<link rel="next" href="limpieza-de-datos.html"/>
<script src="libs/header-attrs-2.2/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Resumen del proyecto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contacto"><i class="fa fa-check"></i><b>1.1</b> Contacto</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dependencias.html"><a href="dependencias.html"><i class="fa fa-check"></i><b>2</b> Dependencias</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dependencias.html"><a href="dependencias.html#configuración"><i class="fa fa-check"></i><b>2.1</b> Configuración</a></li>
<li class="chapter" data-level="2.2" data-path="dependencias.html"><a href="dependencias.html#sesión"><i class="fa fa-check"></i><b>2.2</b> Sesión</a></li>
<li class="chapter" data-level="2.3" data-path="dependencias.html"><a href="dependencias.html#sistema-operativo"><i class="fa fa-check"></i><b>2.3</b> Sistema operativo</a></li>
<li class="chapter" data-level="2.4" data-path="dependencias.html"><a href="dependencias.html#minería-de-datos"><i class="fa fa-check"></i><b>2.4</b> Minería de datos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="dependencias.html"><a href="dependencias.html#bitácora"><i class="fa fa-check"></i><b>2.4.1</b> Bitácora</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html"><i class="fa fa-check"></i><b>3</b> Extracción de datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#método-anterior"><i class="fa fa-check"></i><b>3.1</b> Método anterior</a></li>
<li class="chapter" data-level="3.2" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#cambios"><i class="fa fa-check"></i><b>3.2</b> Cambios</a></li>
<li class="chapter" data-level="3.3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#nuevo-método"><i class="fa fa-check"></i><b>3.3</b> Nuevo método</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#escoge-formato"><i class="fa fa-check"></i><b>3.3.1</b> Escoge formato</a></li>
<li class="chapter" data-level="3.3.2" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#conoce-el-formato"><i class="fa fa-check"></i><b>3.3.2</b> Conoce el formato</a></li>
<li class="chapter" data-level="3.3.3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#descarga-la-información"><i class="fa fa-check"></i><b>3.3.3</b> Descarga la información</a></li>
<li class="chapter" data-level="3.3.4" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#organización-de-la-información"><i class="fa fa-check"></i><b>3.3.4</b> Organización de la información</a></li>
<li class="chapter" data-level="3.3.5" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#extracción-de-datos-1"><i class="fa fa-check"></i><b>3.3.5</b> Extracción de datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html"><i class="fa fa-check"></i><b>4</b> Limpieza de datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-3"><i class="fa fa-check"></i><b>4.1</b> Filtro 3</a></li>
<li class="chapter" data-level="4.2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-4"><i class="fa fa-check"></i><b>4.2</b> Filtro 4</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#top50"><i class="fa fa-check"></i><b>4.2.1</b> Top50</a></li>
<li class="chapter" data-level="4.2.2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#consenso"><i class="fa fa-check"></i><b>4.2.2</b> Consenso</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#obtiene-nombres-y-organismos"><i class="fa fa-check"></i><b>4.3</b> Obtiene nombres y organismos</a></li>
<li class="chapter" data-level="4.4" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#gráficas"><i class="fa fa-check"></i><b>4.4</b> Gráficas</a></li>
<li class="chapter" data-level="4.5" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-5"><i class="fa fa-check"></i><b>4.5</b> Filtro 5</a></li>
<li class="chapter" data-level="4.6" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-6"><i class="fa fa-check"></i><b>4.6</b> Filtro 6</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a>
<ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="color-blind-friendly-palette-with-grey.html"><a href="color-blind-friendly-palette-with-grey.html"><i class="fa fa-check"></i><b>7</b> Color blind friendly palette with grey:</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bitácora</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extracción-de-datos" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Extracción de datos</h1>
<div id="método-anterior" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Método anterior</h2>
<p>En un inicio la extracción de datos se realizó por medio de la interfaz de programación de aplicaciones (API, por sus siglas en inglés) del banco de datos de proteínas (PDB, también por sus siglas en inglés), basado en una ‘búsqueda avanzada’ en formato <code>.xml</code>, como lo describo en el siguiente enlace <a href="https://murpholinox.github.io/getdatafromthePDB/" class="uri">https://murpholinox.github.io/getdatafromthePDB/</a>.</p>
</div>
<div id="cambios" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Cambios</h2>
<p>A finales del 2019, se implementó una nueva API en el sitio <em>web</em> del PDB que no permitió seguir con el proceso anterior, al introducir ciertas restricciones. Por lo menos a esta fecha, 30 de mayo 2020, las restricciones continúan y son las siguientes:</p>
<ol style="list-style-type: decimal">
<li>Después de una ‘búsqueda avanzada’, no es posible descargar el archivo <code>.csv</code> de los resultados de la búsqueda con un número mayor a 2500 líneas.</li>
</ol>
<div class="figure">
<img src="img/2500rows.png" alt="" />
<p class="caption">Restricciones en el PDB</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Después de una ‘búsqueda avanzada’, la opción de descargar un <code>.csv</code> personalizado, es decir, con la posibilidad de seleccionar las columnas de interés, no se encuentra disponible.</li>
</ol>
</div>
<div id="nuevo-método" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Nuevo método</h2>
<p>A causa de lo anterior se decidió emplear la información cruda del PDB, es decir, extraer la información directamente del cabezal de los archivos de las estructuras depositadas en el PDB.</p>
<div id="escoge-formato" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Escoge formato</h3>
<p>El PDB ofrece descargar sus archivos en tres formatos diferentes: <code>.xml</code>, <code>.pdb</code> y <code>.mmcif</code>. El segundo es el más fácil de leer y manipular; sin embargo, se decidió usar el tercer formato debido al siguiente párrafo:</p>
<blockquote>
<p>Many of the errors have been fixed in the equivalent mmCIF files. Hence, if you are interested in the header information, it is a good idea to extract information from mmCIF files…</p>
<p>De <a href="https://biopython.readthedocs.io/en/latest/chapter_pdb.html" class="uri">https://biopython.readthedocs.io/en/latest/chapter_pdb.html</a>.</p>
</blockquote>
</div>
<div id="conoce-el-formato" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Conoce el formato</h3>
<p>El formato <code>.mmcif</code> se detalla en <a href="http://mmcif.wwpdb.org/" class="uri">http://mmcif.wwpdb.org/</a>. Existe una correspondencia entre las etiquetas del <code>.pdb</code> con las del <code>.mmcif</code>.</p>
<blockquote>
<p>El formato <code>.mmcif</code>, tiene como fin reemplazar el formato <code>.pdb</code> (véase <a href="http://mmcif.wwpdb.org/docs/faqs/pdbx-mmcif-faq-general.html" class="uri">http://mmcif.wwpdb.org/docs/faqs/pdbx-mmcif-faq-general.html</a>).</p>
</blockquote>
</div>
<div id="descarga-la-información" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Descarga la información</h3>
<p>Para descargar todo las estructuras del PDB en formato <code>.mmcif</code>, se usa el siguiente comando:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="extracción-de-datos.html#cb10-1"></a><span class="bu">cd</span> /run/media/murphy/lolita/doctorado <span class="co"># Trabaja en el disco duro.</span></span>
<span id="cb10-2"><a href="extracción-de-datos.html#cb10-2"></a><span class="fu">rsync</span> -rlpt -v -z --delete --port=33444 rsync.rcsb.org::ftp_data/structures/divided/mmCIF/ ./PDB </span>
<span id="cb10-3"><a href="extracción-de-datos.html#cb10-3"></a><span class="co"># Tarda 725 minutos!</span></span></code></pre></div>
<blockquote>
<p>Instrucciones de <a href="https://www.wwpdb.org/ftp/pdb-ftp-sites" class="uri">https://www.wwpdb.org/ftp/pdb-ftp-sites</a>.</p>
</blockquote>
</div>
<div id="organización-de-la-información" class="section level3" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Organización de la información</h3>
<p>Las estructuras están organizadas en diferentes subdirectorios, cuyo nombre está formado por el segundo y el tercer carácter del nombre del archivo <code>.mmcif</code>. Por ejemplo <code>1abc.mmcif</code> estará en el subdirectorio <code>ab/</code>. Para las pruebas se hace una copia de este directorio, sin los subdirectorios. Esto tiene dos fines: realizar un respaldo y manipular de una manera más sencilla los archivos.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="extracción-de-datos.html#cb11-1"></a><span class="bu">cd</span> /run/media/murphy/lolita/doctorado</span>
<span id="cb11-2"><a href="extracción-de-datos.html#cb11-2"></a><span class="fu">mkdir</span> PDB_backup</span>
<span id="cb11-3"><a href="extracción-de-datos.html#cb11-3"></a><span class="bu">cd</span> PDB/</span>
<span id="cb11-4"><a href="extracción-de-datos.html#cb11-4"></a><span class="bu">time</span> find . -name <span class="st">&#39;*.gz&#39;</span> -exec cp <span class="dt">\{\}</span> /run/media/murphy/lolita/doctorado/PDB_backup/ <span class="dt">\;</span> </span>
<span id="cb11-5"><a href="extracción-de-datos.html#cb11-5"></a><span class="co"># Esto tarda 36 minutos!</span></span>
<span id="cb11-6"><a href="extracción-de-datos.html#cb11-6"></a><span class="co"># Se confirma con:</span></span>
<span id="cb11-7"><a href="extracción-de-datos.html#cb11-7"></a><span class="co"># cd ../PDB_backup/</span></span>
<span id="cb11-8"><a href="extracción-de-datos.html#cb11-8"></a><span class="co"># find -name &quot;*.gz&quot; | wc -l</span></span>
<span id="cb11-9"><a href="extracción-de-datos.html#cb11-9"></a><span class="co"># 164391</span></span></code></pre></div>
<p>Los archivos descargados están comprimidos en formato <code>gzip</code> (<a href="https://www.gnu.org/software/gzip/" class="uri">https://www.gnu.org/software/gzip/</a>). No es necesario descomprimirlos.</p>
</div>
<div id="extracción-de-datos-1" class="section level3" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Extracción de datos</h3>
<p>La extracción de <code>gemmi</code> funciona de la siguiente manera:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="extracción-de-datos.html#cb12-1"></a><span class="co"># Obtiene número de acceso.</span></span>
<span id="cb12-2"><a href="extracción-de-datos.html#cb12-2"></a><span class="co"># time gemmi grep _struct_ref.pdbx_db_accession xrays/ &gt; from_xrays_get_ide</span></span>
<span id="cb12-3"><a href="extracción-de-datos.html#cb12-3"></a><span class="co"># Esto tarda 83 minutos!</span></span>
<span id="cb12-4"><a href="extracción-de-datos.html#cb12-4"></a><span class="co"># Obtiene número de entidades.</span></span>
<span id="cb12-5"><a href="extracción-de-datos.html#cb12-5"></a><span class="co"># time gemmi grep _entity_poly.entity_id xrays/ &gt; from_xrays_get_nde</span></span>
<span id="cb12-6"><a href="extracción-de-datos.html#cb12-6"></a><span class="co"># Esto tarda 73 minutos!</span></span>
<span id="cb12-7"><a href="extracción-de-datos.html#cb12-7"></a><span class="co"># Obtiene anteriores y tipo de entidad.</span></span>
<span id="cb12-8"><a href="extracción-de-datos.html#cb12-8"></a><span class="co"># time gemmi grep _struct_ref.pdbx_db_accession -a _entity_poly.entity_id -a _entity_poly.type xrays/ &gt; from_xrays_get_ide_nde_tde </span></span>
<span id="cb12-9"><a href="extracción-de-datos.html#cb12-9"></a><span class="co"># Esto tarda 75 minutos!</span></span>
<span id="cb12-10"><a href="extracción-de-datos.html#cb12-10"></a><span class="co"># Estos resultados no producen datos rectangulares, por la ausencia de un delimitador apropiado.</span></span></code></pre></div>
<div id="separa-entradas-por-método-experimental" class="section level4" number="3.3.5.1">
<h4><span class="header-section-number">3.3.5.1</span> Separa entradas por método experimental</h4>
<p>Del universo de archivos depositados en el PDB, obtenemos aquellas estructuras determinadas por cristalografía de rayos-X (CRX). Esto ayuda a reducir confusiones posteriores. Estas confusiones surgen porque <code>gemmi</code>, extrae etiquetas pero no conoce contextos. Esto puede resultar, dependiendo de las etiquetas, en una producción de un archivo de texto con un número de columnas variable por línea, es decir, datos en forma no rectangular.</p>
<blockquote>
<p>Advertencia: La mayor parte del <code>tidyverse</code> trabaja con datos rectangulares, mismo número de columnas en todas las líneas, por lo que es esencial obtener datos de esta forma.</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="extracción-de-datos.html#cb13-1"></a><span class="bu">cd</span> /run/media/murphy/lolita/doctorado/</span>
<span id="cb13-2"><a href="extracción-de-datos.html#cb13-2"></a><span class="fu">mkdir</span> extract</span>
<span id="cb13-3"><a href="extracción-de-datos.html#cb13-3"></a><span class="bu">time</span> gemmi grep _exptl.method PDB_backup/ <span class="op">&gt;</span> ./extract/method.dat <span class="co"># Esto tarda 74 minutos!</span></span>
<span id="cb13-4"><a href="extracción-de-datos.html#cb13-4"></a><span class="bu">cd</span> extract/</span>
<span id="cb13-5"><a href="extracción-de-datos.html#cb13-5"></a><span class="fu">grep</span> X-RAY method.dat <span class="kw">|</span> <span class="fu">awk</span> -F : <span class="st">&#39;{print $1}&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39;[:upper:]&#39;</span> <span class="st">&#39;[:lower:]&#39;</span> <span class="op">&gt;</span> pdbs_by_xray.dat</span>
<span id="cb13-6"><a href="extracción-de-datos.html#cb13-6"></a><span class="fu">sed</span> <span class="st">&#39;s/$/.cig.gz/&#39;</span>g pdbs_by_xray.dat <span class="op">&gt;</span> list_pdbs_by_xray</span>
<span id="cb13-7"><a href="extracción-de-datos.html#cb13-7"></a><span class="co"># Es interesante comparar el número de entradas por CRX contra el total:</span></span>
<span id="cb13-8"><a href="extracción-de-datos.html#cb13-8"></a><span class="co"># wc -l method.dat pdbs_by_xray.dat</span></span>
<span id="cb13-9"><a href="extracción-de-datos.html#cb13-9"></a><span class="co"># 164558 method.dat</span></span>
<span id="cb13-10"><a href="extracción-de-datos.html#cb13-10"></a><span class="co"># 146114 pdbs_by_xray.dat</span></span>
<span id="cb13-11"><a href="extracción-de-datos.html#cb13-11"></a><span class="co"># Es decir, 88.79 % de las entradas en el PDB son por CRX.</span></span>
<span id="cb13-12"><a href="extracción-de-datos.html#cb13-12"></a><span class="fu">mkdir</span> xrays</span>
<span id="cb13-13"><a href="extracción-de-datos.html#cb13-13"></a><span class="bu">time</span> cat list_pdbs_by_xray <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> <span class="va">line</span>;</span>
<span id="cb13-14"><a href="extracción-de-datos.html#cb13-14"></a><span class="kw">do</span> <span class="fu">cp</span> /run/media/murphy/lolita/doctorado/PDB_backup/<span class="va">$line</span> xrays/<span class="kw">;</span> <span class="kw">done</span> </span>
<span id="cb13-15"><a href="extracción-de-datos.html#cb13-15"></a><span class="co"># Esto tarda 49 minutos!</span></span></code></pre></div>
</div>
<div id="extrae-datos" class="section level4" number="3.3.5.2">
<h4><span class="header-section-number">3.3.5.2</span> Extrae datos</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="extracción-de-datos.html#cb14-1"></a><span class="co"># El primer delimitador usado fue &lt;TAB&gt; (\t).</span></span>
<span id="cb14-2"><a href="extracción-de-datos.html#cb14-2"></a><span class="co"># time gemmi grep --delimiter=&#39;\t&#39; _entity_poly.entity_id -a _entity_poly.type -a _struct_ref.pdbx_db_accession -a _entity.pdbx_description -a _exptl_crystal_grow.method -a _exptl_crystal_grow.pH -a _exptl_crystal_grow.pdbx_details -a _reflns.d_resolution_high -a _reflns_shell.d_res_high -a _symmetry.space_group_name_H-M -a _citation.pdbx_database_id_DOI xrays/ &gt; todo</span></span>
<span id="cb14-3"><a href="extracción-de-datos.html#cb14-3"></a><span class="co"># Esto tarda 45 minutos! </span></span>
<span id="cb14-4"><a href="extracción-de-datos.html#cb14-4"></a><span class="co"># Estos resultados no producen datos rectangulares, por la presencia de &lt;TAB&gt; en la columna de la condición de cristalización.</span></span>
<span id="cb14-5"><a href="extracción-de-datos.html#cb14-5"></a><span class="co"># La solución es usar un delimitador que jamás podría aparecer en los archivos `.mmcif`.</span></span>
<span id="cb14-6"><a href="extracción-de-datos.html#cb14-6"></a><span class="bu">cd</span> /run/media/murphy/lolita/doctorado/extract</span>
<span id="cb14-7"><a href="extracción-de-datos.html#cb14-7"></a><span class="bu">time</span> gemmi grep --delimiter=<span class="st">&#39;¿&#39;</span> _entity_poly.entity_id -a _entity_poly.type -a _struct_ref.pdbx_db_accession -a _entity.pdbx_description -a _exptl_crystal_grow.method -a _exptl_crystal_grow.pH -a _exptl_crystal_grow.pdbx_details -a _reflns.d_resolution_high -a _reflns_shell.d_res_high -a _symmetry.space_group_name_H-M -a _citation.pdbx_database_id_DOI xrays/ <span class="op">&gt;</span> todo2</span>
<span id="cb14-8"><a href="extracción-de-datos.html#cb14-8"></a><span class="co"># Esto tarda 45 minutos!</span></span></code></pre></div>
<p>Importa los datos extraídos a <code>R</code> y los verifica.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="extracción-de-datos.html#cb15-1"></a>todo2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;/run/media/murphy/lolita/doctorado/extract/todo2&quot;</span>, </span>
<span id="cb15-2"><a href="extracción-de-datos.html#cb15-2"></a>    <span class="st">&quot;¿&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>, </span>
<span id="cb15-3"><a href="extracción-de-datos.html#cb15-3"></a>    <span class="dt">comment =</span> <span class="st">&quot;*&gt;&quot;</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-4"><a href="extracción-de-datos.html#cb15-4"></a><span class="co"># La configuración regional de mi sistema está en inglés, `R` también por lo que no reconoce &#39;¿&#39;.</span></span>
<span id="cb15-5"><a href="extracción-de-datos.html#cb15-5"></a>pdb&lt;-todo2<span class="op">$</span>X1</span>
<span id="cb15-6"><a href="extracción-de-datos.html#cb15-6"></a>nde&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X2, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-7"><a href="extracción-de-datos.html#cb15-7"></a>tde&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X3, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-8"><a href="extracción-de-datos.html#cb15-8"></a>ide&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X4, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-9"><a href="extracción-de-datos.html#cb15-9"></a>nom&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X5, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-10"><a href="extracción-de-datos.html#cb15-10"></a>tec&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X6, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-11"><a href="extracción-de-datos.html#cb15-11"></a>peh&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X7, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-12"><a href="extracción-de-datos.html#cb15-12"></a>con&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X8, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-13"><a href="extracción-de-datos.html#cb15-13"></a>rs1&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X9, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-14"><a href="extracción-de-datos.html#cb15-14"></a>rs2&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X10, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-15"><a href="extracción-de-datos.html#cb15-15"></a>gpo&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X11, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-16"><a href="extracción-de-datos.html#cb15-16"></a>doi&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X12, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-17"><a href="extracción-de-datos.html#cb15-17"></a>datos&lt;-<span class="kw">data.frame</span>(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)</span>
<span id="cb15-18"><a href="extracción-de-datos.html#cb15-18"></a><span class="kw">rm</span>(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)</span>
<span id="cb15-19"><a href="extracción-de-datos.html#cb15-19"></a><span class="co"># Cuidado con el tipo de las columnas.</span></span>
<span id="cb15-20"><a href="extracción-de-datos.html#cb15-20"></a>datos<span class="op">$</span>nde&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>nde)))</span>
<span id="cb15-21"><a href="extracción-de-datos.html#cb15-21"></a>datos<span class="op">$</span>peh&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>peh)))</span>
<span id="cb15-22"><a href="extracción-de-datos.html#cb15-22"></a>datos<span class="op">$</span>rs1&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>rs1)))</span>
<span id="cb15-23"><a href="extracción-de-datos.html#cb15-23"></a>datos<span class="op">$</span>rs2&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>rs2)))</span>
<span id="cb15-24"><a href="extracción-de-datos.html#cb15-24"></a><span class="co"># Verificamos los datos al graficar algunas variables interesantes:</span></span>
<span id="cb15-25"><a href="extracción-de-datos.html#cb15-25"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</span>
<span id="cb15-26"><a href="extracción-de-datos.html#cb15-26"></a><span class="co"># Histograma del pH.</span></span>
<span id="cb15-27"><a href="extracción-de-datos.html#cb15-27"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>peh)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;pH&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="extracción-de-datos.html#cb16-1"></a><span class="co"># Histograma de la resolución.</span></span>
<span id="cb16-2"><a href="extracción-de-datos.html#cb16-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>rs1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Resolución (Å)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="extracción-de-datos.html#cb17-1"></a><span class="co"># Histograma del número de entidades.</span></span>
<span id="cb17-2"><a href="extracción-de-datos.html#cb17-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>nde)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Número de entidades&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="extracción-de-datos.html#cb18-1"></a><span class="co"># Determina cuentas por grupo de grupos espaciales y tido de entidad.</span></span>
<span id="cb18-2"><a href="extracción-de-datos.html#cb18-2"></a>df1&lt;-datos <span class="op">%&gt;%</span></span>
<span id="cb18-3"><a href="extracción-de-datos.html#cb18-3"></a><span class="st">  </span><span class="kw">add_count</span>(gpo, <span class="dt">name =</span> <span class="st">&quot;cta_gpo&quot;</span>)</span>
<span id="cb18-4"><a href="extracción-de-datos.html#cb18-4"></a>df2&lt;-df1 <span class="op">%&gt;%</span></span>
<span id="cb18-5"><a href="extracción-de-datos.html#cb18-5"></a><span class="st">  </span><span class="kw">add_count</span>(tde, <span class="dt">name =</span> <span class="st">&quot;cta_tde&quot;</span>)</span>
<span id="cb18-6"><a href="extracción-de-datos.html#cb18-6"></a>tab_gpo&lt;-datos <span class="op">%&gt;%</span></span>
<span id="cb18-7"><a href="extracción-de-datos.html#cb18-7"></a><span class="st">  </span><span class="kw">count</span>(gpo, <span class="dt">name =</span> <span class="st">&quot;cta_gpo&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb18-8"><a href="extracción-de-datos.html#cb18-8"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cta_gpo))</span>
<span id="cb18-9"><a href="extracción-de-datos.html#cb18-9"></a>tab_tde&lt;-datos <span class="op">%&gt;%</span></span>
<span id="cb18-10"><a href="extracción-de-datos.html#cb18-10"></a><span class="st">  </span><span class="kw">count</span>(tde, <span class="dt">name =</span> <span class="st">&quot;cta_tde&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb18-11"><a href="extracción-de-datos.html#cb18-11"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cta_tde))</span>
<span id="cb18-12"><a href="extracción-de-datos.html#cb18-12"></a><span class="co"># Gráfico de barras de los grupos espaciales.</span></span>
<span id="cb18-13"><a href="extracción-de-datos.html#cb18-13"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(gpo, cta_gpo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Grupo espacial&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="extracción-de-datos.html#cb19-1"></a><span class="co"># Es interesante notar que el número de grupos espaciales es mayor a 65.</span></span>
<span id="cb19-2"><a href="extracción-de-datos.html#cb19-2"></a>gpo_rar &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></span>
<span id="cb19-3"><a href="extracción-de-datos.html#cb19-3"></a><span class="st">  </span><span class="kw">filter</span>(cta_gpo <span class="op">&lt;=</span><span class="st"> </span><span class="dv">15</span>)</span>
<span id="cb19-4"><a href="extracción-de-datos.html#cb19-4"></a><span class="co"># Gráfico de barras de los grupos espaciales menos comunes. </span></span>
<span id="cb19-5"><a href="extracción-de-datos.html#cb19-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> gpo_rar, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(gpo, cta_gpo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Grupo espacial&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Grupos espaciales con una frecuencia menor o igual a 15&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()<span class="co">#+ theme(axis.text.x = element_text(size = 12, angle = 45)) </span></span></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-14-5.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="extracción-de-datos.html#cb20-1"></a><span class="co"># Genera tablas.</span></span>
<span id="cb20-2"><a href="extracción-de-datos.html#cb20-2"></a><span class="co"># Tabla de grupos espaciales en el PDB.</span></span>
<span id="cb20-3"><a href="extracción-de-datos.html#cb20-3"></a><span class="kw">kable</span>(tab_gpo) <span class="op">%&gt;%</span></span>
<span id="cb20-4"><a href="extracción-de-datos.html#cb20-4"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width=</span>F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
gpo
</th>
<th style="text-align:right;">
cta_gpo
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P 21 21 21
</td>
<td style="text-align:right;">
58553
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21 1
</td>
<td style="text-align:right;">
40925
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 2 1
</td>
<td style="text-align:right;">
21183
</td>
</tr>
<tr>
<td style="text-align:left;">
C 2 2 21
</td>
<td style="text-align:right;">
12353
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 21 2
</td>
<td style="text-align:right;">
9612
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 21 2
</td>
<td style="text-align:right;">
8377
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1
</td>
<td style="text-align:right;">
8087
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 21 2
</td>
<td style="text-align:right;">
6933
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31 2 1
</td>
<td style="text-align:right;">
5678
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32 2 1
</td>
<td style="text-align:right;">
5497
</td>
</tr>
<tr>
<td style="text-align:left;">
I 2 2 2
</td>
<td style="text-align:right;">
4805
</td>
</tr>
<tr>
<td style="text-align:left;">
P 61 2 2
</td>
<td style="text-align:right;">
3107
</td>
</tr>
<tr>
<td style="text-align:left;">
P 65 2 2
</td>
<td style="text-align:right;">
2964
</td>
</tr>
<tr>
<td style="text-align:left;">
H 3 2
</td>
<td style="text-align:right;">
2778
</td>
</tr>
<tr>
<td style="text-align:left;">
H 3
</td>
<td style="text-align:right;">
2510
</td>
</tr>
<tr>
<td style="text-align:left;">
P 61
</td>
<td style="text-align:right;">
2319
</td>
</tr>
<tr>
<td style="text-align:left;">
P 65
</td>
<td style="text-align:right;">
2040
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4 2 2
</td>
<td style="text-align:right;">
1738
</td>
</tr>
<tr>
<td style="text-align:left;">
P 63
</td>
<td style="text-align:right;">
1474
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41
</td>
<td style="text-align:right;">
1246
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 21 21
</td>
<td style="text-align:right;">
1168
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32
</td>
<td style="text-align:right;">
1153
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31
</td>
<td style="text-align:right;">
1146
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43
</td>
<td style="text-align:right;">
1125
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41 2 2
</td>
<td style="text-align:right;">
1088
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 21 2
</td>
<td style="text-align:right;">
1046
</td>
</tr>
<tr>
<td style="text-align:left;">
P 63 2 2
</td>
<td style="text-align:right;">
1010
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4
</td>
<td style="text-align:right;">
987
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 3
</td>
<td style="text-align:right;">
948
</td>
</tr>
<tr>
<td style="text-align:left;">
I 2 3
</td>
<td style="text-align:right;">
797
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3 2 1
</td>
<td style="text-align:right;">
734
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 21 2
</td>
<td style="text-align:right;">
626
</td>
</tr>
<tr>
<td style="text-align:left;">
P 62 2 2
</td>
<td style="text-align:right;">
591
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 2 2
</td>
<td style="text-align:right;">
584
</td>
</tr>
<tr>
<td style="text-align:left;">
I 21 3
</td>
<td style="text-align:right;">
561
</td>
</tr>
<tr>
<td style="text-align:left;">
P 64 2 2
</td>
<td style="text-align:right;">
524
</td>
</tr>
<tr>
<td style="text-align:left;">
I 1 2 1
</td>
<td style="text-align:right;">
514
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 2 2
</td>
<td style="text-align:right;">
505
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41
</td>
<td style="text-align:right;">
484
</td>
</tr>
<tr>
<td style="text-align:left;">
I 21 21 21
</td>
<td style="text-align:right;">
466
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 2 21
</td>
<td style="text-align:right;">
465
</td>
</tr>
<tr>
<td style="text-align:left;">
C 2 2 2
</td>
<td style="text-align:right;">
450
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 2 1
</td>
<td style="text-align:right;">
437
</td>
</tr>
<tr>
<td style="text-align:left;">
P 64
</td>
<td style="text-align:right;">
398
</td>
</tr>
<tr>
<td style="text-align:left;">
P 6
</td>
<td style="text-align:right;">
388
</td>
</tr>
<tr>
<td style="text-align:left;">
P 62
</td>
<td style="text-align:right;">
363
</td>
</tr>
<tr>
<td style="text-align:left;">
F 4 3 2
</td>
<td style="text-align:right;">
322
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3
</td>
<td style="text-align:right;">
316
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 3 2
</td>
<td style="text-align:right;">
293
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 2 21
</td>
<td style="text-align:right;">
275
</td>
</tr>
<tr>
<td style="text-align:left;">
F 2 2 2
</td>
<td style="text-align:right;">
272
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32 1 2
</td>
<td style="text-align:right;">
233
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31 1 2
</td>
<td style="text-align:right;">
214
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4 3 2
</td>
<td style="text-align:right;">
183
</td>
</tr>
<tr>
<td style="text-align:left;">
F 2 3
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:left;">
P 6 2 2
</td>
<td style="text-align:right;">
166
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 3 2
</td>
<td style="text-align:right;">
163
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4
</td>
<td style="text-align:right;">
158
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42
</td>
<td style="text-align:right;">
153
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41 3 2
</td>
<td style="text-align:right;">
128
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 2 2
</td>
<td style="text-align:right;">
119
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 3
</td>
<td style="text-align:right;">
116
</td>
</tr>
<tr>
<td style="text-align:left;">
F 41 3 2
</td>
<td style="text-align:right;">
102
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 3 2
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 2 2
</td>
<td style="text-align:right;">
76
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 3 2
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:left;">
P -1
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:left;">
B 1 1 2
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3 1 2
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 2 2
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 1 21
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
I 1 21 1
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
R 3
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21/n 1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 2 2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
R 3 2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 21 2 A
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 21 1
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21/c 1
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 2/c 1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41/a
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 21 2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
A 1 2 1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
P b c a
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
C 4 21 2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
F 4 2 2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
H -3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
P n n a
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
A 1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B 2 21 2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
I -4 2 d
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
I -4 c 2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P -3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P c a b
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="extracción-de-datos.html#cb21-1"></a><span class="co"># Tabla del tipo de entidades en el PDB.</span></span>
<span id="cb21-2"><a href="extracción-de-datos.html#cb21-2"></a><span class="kw">kable</span>(tab_tde) <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="extracción-de-datos.html#cb21-3"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width=</span>F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
tde
</th>
<th style="text-align:right;">
cta_tde
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
polypeptide(L)
</td>
<td style="text-align:right;">
208248
</td>
</tr>
<tr>
<td style="text-align:left;">
polydeoxyribonucleotide
</td>
<td style="text-align:right;">
10845
</td>
</tr>
<tr>
<td style="text-align:left;">
polyribonucleotide
</td>
<td style="text-align:right;">
5268
</td>
</tr>
<tr>
<td style="text-align:left;">
polydeoxyribonucleotide/polyribonucleotide hybrid
</td>
<td style="text-align:right;">
171
</td>
</tr>
<tr>
<td style="text-align:left;">
polypeptide(D)
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:left;">
peptide nucleic acid
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="extracción-de-datos.html#cb22-1"></a><span class="kw">rm</span>(todo2, df1, datos)</span>
<span id="cb22-2"><a href="extracción-de-datos.html#cb22-2"></a><span class="co"># Guarda datos como `.csv`.</span></span>
<span id="cb22-3"><a href="extracción-de-datos.html#cb22-3"></a><span class="kw">write_excel_csv</span>(df2, <span class="st">&quot;/run/media/murphy/lolita/doctorado/extract/df2.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dependencias.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="limpieza-de-datos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["arrozconleche.pdf", "arrozconleche.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
