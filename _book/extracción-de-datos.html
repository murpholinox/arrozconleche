<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bitácora</title>
  <meta name="description" content="Bitácora de doctorado" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Bitácora" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Bitácora de doctorado" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bitácora" />
  
  <meta name="twitter:description" content="Bitácora de doctorado" />
  

<meta name="author" content="Francisco Murphy Pérez" />


<meta name="date" content="2020-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dependencias.html"/>
<link rel="next" href="limpieza-de-datos.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Resumen del proyecto</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contacto"><i class="fa fa-check"></i><b>1.1</b> Contacto</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dependencias.html"><a href="dependencias.html"><i class="fa fa-check"></i><b>2</b> Dependencias</a><ul>
<li class="chapter" data-level="2.1" data-path="dependencias.html"><a href="dependencias.html#sistema-operativo"><i class="fa fa-check"></i><b>2.1</b> Sistema operativo</a></li>
<li class="chapter" data-level="2.2" data-path="dependencias.html"><a href="dependencias.html#minería-de-datos"><i class="fa fa-check"></i><b>2.2</b> Minería de datos</a></li>
<li class="chapter" data-level="2.3" data-path="dependencias.html"><a href="dependencias.html#bitácora"><i class="fa fa-check"></i><b>2.3</b> Bitácora</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html"><i class="fa fa-check"></i><b>3</b> Extracción de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#método-anterior"><i class="fa fa-check"></i><b>3.1</b> Método anterior</a></li>
<li class="chapter" data-level="3.2" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#cambios"><i class="fa fa-check"></i><b>3.2</b> Cambios</a></li>
<li class="chapter" data-level="3.3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#nuevo-método"><i class="fa fa-check"></i><b>3.3</b> Nuevo método</a><ul>
<li class="chapter" data-level="3.3.1" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#escoge-formato"><i class="fa fa-check"></i><b>3.3.1</b> Escoge formato</a></li>
<li class="chapter" data-level="3.3.2" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#conoce-el-formato"><i class="fa fa-check"></i><b>3.3.2</b> Conoce el formato</a></li>
<li class="chapter" data-level="3.3.3" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#descarga-la-información"><i class="fa fa-check"></i><b>3.3.3</b> Descarga la información</a></li>
<li class="chapter" data-level="3.3.4" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#organización-de-la-información"><i class="fa fa-check"></i><b>3.3.4</b> Organización de la información</a></li>
<li class="chapter" data-level="3.3.5" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#filtra-por-método-experimental"><i class="fa fa-check"></i><b>3.3.5</b> Filtra por método experimental</a></li>
<li class="chapter" data-level="3.3.6" data-path="extracción-de-datos.html"><a href="extracción-de-datos.html#extrae-información"><i class="fa fa-check"></i><b>3.3.6</b> Extrae información</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html"><i class="fa fa-check"></i><b>4</b> Limpieza de datos</a><ul>
<li class="chapter" data-level="4.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-1"><i class="fa fa-check"></i><b>4.1</b> Filtro 1</a></li>
<li class="chapter" data-level="4.2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-2"><i class="fa fa-check"></i><b>4.2</b> Filtro 2</a></li>
<li class="chapter" data-level="4.3" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#filtro-3"><i class="fa fa-check"></i><b>4.3</b> Filtro 3</a></li>
<li class="chapter" data-level="4.4" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#realiza-primer-listado"><i class="fa fa-check"></i><b>4.4</b> Realiza primer listado</a></li>
<li class="chapter" data-level="4.5" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#falta"><i class="fa fa-check"></i><b>4.5</b> FALTA</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bitácora</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extracción-de-datos" class="section level1">
<h1><span class="header-section-number">3</span> Extracción de datos</h1>
<div id="método-anterior" class="section level2">
<h2><span class="header-section-number">3.1</span> Método anterior</h2>
<p>En un inicio la extracción de datos se realizaba por medio de la interfaz de programación de aplicaciones (API, por sus siglas en inglés) del banco de datos de proteínas (PDB, por sus siglas en inglés), basado en una ‘búsqueda avanzada’ en formato <code>.xml</code>, como se describe en este <a href="https://murpholinox.github.io/getdatafromthePDB/"><em>post</em></a>.</p>
</div>
<div id="cambios" class="section level2">
<h2><span class="header-section-number">3.2</span> Cambios</h2>
<p>A finales del 2019, hubo una serie de cambios al sitio <em>web</em> del PDB que no permitieron seguir con el proceso anterior, al introducir ciertas restricciones. Por lo menos a esta fecha, 30 de mayo 2020, las restricciones continúan y son las siguientes:</p>
<ol style="list-style-type: decimal">
<li>Después de una ‘búsqueda avanzada’, no es posible descargar el archivo <code>.csv</code> de los resultados de la búsqueda con un número mayor a 2500 líneas.</li>
</ol>
<div class="figure">
<img src="img/2500rows.png" alt="Restricciones en el PDB" />
<p class="caption">Restricciones en el PDB</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Después de una ‘búsqueda avanzada’, la opción de descargar un <code>.csv</code> personalizado, es decir, con la posibilidad de seleccionar las columnas de interés, no se encuentra disponible.</li>
</ol>
<blockquote>
<p>Justo estas dos limitantes interfieren con los últimos pasos del primer intento de la extracción de datos.</p>
</blockquote>
</div>
<div id="nuevo-método" class="section level2">
<h2><span class="header-section-number">3.3</span> Nuevo método</h2>
<p>Debido a estas restricciones se decidió emplear la información cruda del PDB, es decir, se decidió obtener la información directamente del cabezal de los archivos de las estructuras depositadas en el PDB.</p>
<div id="escoge-formato" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Escoge formato</h3>
<p>El PDB ofrece archivos en tres formatos diferentes, <code>.xml</code>, <code>.pdb</code> y <code>.mmcif</code>. El segundo es el más fácil de leer y manipular; sin embargo, se decidió usar el tercer formato debido a lo siguiente:</p>
<blockquote>
<p>Many of the errors have been fixed in the equivalent mmCIF files. Hence, if you are interested in the header information, it is a good idea to extract information from mmCIF files…</p>
<p>De la documentación de <code>biopython</code>, <a href="https://biopython.readthedocs.io/en/latest/chapter_pdb.html">aquí</a>.</p>
</blockquote>
</div>
<div id="conoce-el-formato" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Conoce el formato</h3>
<p>El formato <code>.mmcif</code> se detalla en esta <a href="http://mmcif.wwpdb.org/">página</a> y cabe señalar que existe una correspondencia entre las etiquetas del <code>.pdb</code> con las del <code>.mmcif</code> (véase <a href="http://mmcif.wwpdb.org/docs/pdb_to_pdbx_correspondences.html">aquí</a>).</p>
<blockquote>
<p>El formato <code>.mmcif</code>, tiene como fin reemplazar el formato <code>.pdb</code> (información <a href="http://mmcif.wwpdb.org/docs/faqs/pdbx-mmcif-faq-general.html">aquí</a>).</p>
</blockquote>
<blockquote>
<p>Desde abril del 2019, es indispensable depositar la estructura de tu proteína de interés en formato <code>.mmcif</code> (información <a href="https://journals.iucr.org/d/issues/2019/04/00/rr5177/">aquí</a>).</p>
</blockquote>
</div>
<div id="descarga-la-información" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Descarga la información</h3>
<p>Para descargar todo las estructuras del PDB en formato <code>.mmcif</code>, se usa el siguiente comando:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="bu">cd</span> /run/media/murphy/lolita/doctorado <span class="co"># Trabaja en el disco duro.</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="fu">rsync</span> -rlpt -v -z --delete --port=33444 <span class="dt">\ </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="ex">rsync.rcsb.org</span>::ftp_data/structures/divided/mmCIF/ ./PDB </a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Tarda 725 minutos!</span></a></code></pre></div>
<blockquote>
<p>Instrucciones tomadas del mismo PDB, <a href="https://www.wwpdb.org/ftp/pdb-ftp-sites">aquí</a>.</p>
</blockquote>
</div>
<div id="organización-de-la-información" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Organización de la información</h3>
<p>Las estructuras están organizadas en diferentes subdirectorios, cuyo nombre está formado por el segundo y el tercer carácter del archivo <code>.mmcif</code>. Por ejemplo <code>1ABC.mmcif</code> estará en el subdirectorio <code>ab/</code>. Para las pruebas se hace una copia de este directorio, sin los subdirectorios. Esto tiene dos fines: uno, se tiene un <em>backup</em> y dos, es más simple manipular los archivos en un solo directorio.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="bu">cd</span> /run/media/murphy/lolita/doctorado</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="fu">mkdir</span> PDB_backup</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="bu">cd</span> PDB/</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="bu">time</span> find . -name <span class="st">&#39;*.gz&#39;</span> -exec cp <span class="dt">\{\}</span> /run/media/murphy/lolita/doctorado/PDB_backup/ <span class="dt">\;</span> <span class="co"># Hay que dar la ruta absoluta.</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># Esto tarda 36 minutos!</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co"># Se confirma con:</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#find -name &quot;*.gz&quot; | wc -l</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#164391</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#cd ../PDB_backup/</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#find -name &quot;*.gz&quot; | wc -l</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#164391</span></a></code></pre></div>
<p>Por otra parte, los archivos están comprimidos en formato <code>gunzip</code> (<a href="https://linux.die.net/man/1/gunzip">aquí</a> su documentación) y así se mantendran ya que no es necesario descomprimirlos.</p>
</div>
<div id="filtra-por-método-experimental" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Filtra por método experimental</h3>
<p>Del universo de estructuras del PDB, obtenemos aquellas estructuras determinadas por cristalografía de rayos-X. Este filtro ayuda a reducir confusiones posteriores. Estas confusiones surgen porque <code>gemmi</code>, extrae etiquetas pero no conoce contextos. Esto puede resultar, dependiendo de las etiquetas a extraer, en una producción de un archivo de texto con un número de columnas variable por línea, es decir, datos en forma no rectangular.</p>
<blockquote>
<p>La mayor parte del <code>tidyverse</code> trabaja con datos rectangulares, mismo número de columnas en todas las líneas, por lo que es esencial obtener datos de esta forma.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="bu">cd</span> /run/media/murphy/lolita/doctorado/PDB_backup</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="fu">mkdir</span> extract</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="bu">time</span> gemmi grep _exptl.method PDB_backup/ <span class="op">&gt;</span> ./extract/method.dat <span class="co"># Esto tarda 74 minutos!</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="bu">time</span> grep X-RAY ./extract/method.dat <span class="kw">|</span> <span class="fu">awk</span> -F : <span class="st">&#39;{print $1}&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39;[:upper:]&#39;</span> <span class="st">&#39;[:lower:]&#39;</span> <span class="op">&gt;</span> ./extract/pdbs_by_xray.dat <span class="co"># Esto tarda 0.93 segundos.</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># En vim pdbs_by_xray y haz :%s/$/.cif.gz/ y :sav list_pdbs_by_xray y :q</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="fu">mv</span> list_pdbs_by_xray extract/</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="bu">cd</span> extract/</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># Es interesante comparar el número de entradas por</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co"># X-RAYs contra el total</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#wc -l method.dat pdbs_by_xray.dat</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co"># 164558 method.dat</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co"># 146114 pdbs_by_xray.dat</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co"># 88.79 % de las entradas en el PDB son por X-Rays</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="fu">mkdir</span> xrays</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="bu">time</span> cat list_pdbs_by_xray <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> <span class="va">line</span>;</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="kw">do</span> <span class="fu">cp</span> ../PDB_backup/<span class="va">$line</span> xrays/<span class="kw">;</span> <span class="kw">done</span> </a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co"># Esto tarda 49 minutos</span></a></code></pre></div>
</div>
<div id="extrae-información" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Extrae información</h3>
<p><code>gemmi</code> funciona de la siguiente manera:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Obtiene número de acceso:</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#time gemmi grep _struct_ref.pdbx_db_accession xrays/ &gt; from_xrays_get_accession_code</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co"># Esto tarda 83 minutos!</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># Obtiene número de entidades:</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#time gemmi grep _struct_ref.entity_id xrays/ &gt; from_xrays_get_number_of_entities</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># Esto tarda 73 minutos!</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#time gemmi grep _entity_poly.entity_id -a _entity_poly.type -a _struct_ref.pdbx_db_accession  xrays/ &gt; from_xrays_get_ne_te_ac </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co"># Esto tarda 75 minutos!</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co"># Si bien esto funciona, los resultados generados no producen</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co"># datos rectangulares, por la falta de un delimitador apropiado.</span></a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># El primer delimitador a probar fue TAB (\t)</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#time gemmi grep --delimiter=&#39;\t&#39; _entity_poly.entity_id -a _entity_poly.type -a _struct_ref.pdbx_db_accession -a _entity.pdbx_description -a _exptl_crystal_grow.method -a _exptl_crystal_grow.pH -a _exptl_crystal_grow.pdbx_details -a _reflns.d_resolution_high -a _reflns_shell.d_res_high -a _symmetry.space_group_name_H-M -a _citation.pdbx_database_id_DOI xrays/ &gt; todo</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># Esto tarda 45 minutos! </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Sin embargo, el campo donde se anotan las condiciones </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># experimentales de la cristalización, contienen </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co"># este delimitador. La limpieza de datos no es fácil:</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#awk &#39;</span><span class="re">BEGIN</span><span class="co">{FS=&quot;\t&quot;;}{if(NF&gt;12) print $0;}&#39; todo &gt; errores</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#cat errores # Para ver las líneas mal formateadas.</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co"># En vim %s/\\^I/ /g</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#awk &#39;</span><span class="re">BEGIN</span><span class="co">{FS=&quot;\t&quot;;}{if(NF!=12) print $0;}&#39; todo_fix.tsv # Confirma</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co"># Desafortunadamente, esto todavía no es suficiente.</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co"># ¿Por qué? No sé. Debe haber caracteres raros en los datos.</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co"># Probé con un delimitador que jamás podría estar</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co"># en los archivos `mmcif`, &#39;¿&#39;...</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># (básicamente por que no existe en inglés).</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="bu">cd</span> /run/media/murphy/lolita/doctorado/extract</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="bu">time</span> gemmi grep --delimiter=<span class="st">&#39;¿&#39;</span> _entity_poly.entity_id -a _entity_poly.type -a _struct_ref.pdbx_db_accession -a _entity.pdbx_description -a _exptl_crystal_grow.method -a _exptl_crystal_grow.pH -a _exptl_crystal_grow.pdbx_details -a _reflns.d_resolution_high -a _reflns_shell.d_res_high -a _symmetry.space_group_name_H-M -a _citation.pdbx_database_id_DOI xrays/ <span class="op">&gt;</span> todo2</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co"># Esto tarda 45 minutos!</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">todo2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;/run/media/murphy/lolita/doctorado/extract/todo2&quot;</span>, </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">    <span class="st">&quot;¿&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb12-4" data-line-number="4">    <span class="dt">comment =</span> <span class="st">&quot;*&gt;&quot;</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co"># El locale de mi sistema, por lo tanto el de `R` está</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># en inglés, por lo que `R` no reconoce el delimitador usado.</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">pdb&lt;-todo2<span class="op">$</span>X1</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">nde&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X2, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">tde&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X3, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">ide&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X4, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">nom&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X5, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">tec&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X6, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">peh&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X7, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">con&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X8, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">rs1&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X9, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">rs2&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X10, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">gpo&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X11, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">doi&lt;-stringr<span class="op">::</span><span class="kw">str_replace</span>(todo2<span class="op">$</span>X12, <span class="st">&#39;�&#39;</span>, <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co"># !!!  Ayer no sabía cómo hacer esto en `R`, así que pedí ayuda y mi papá hizo un macro en excel escrito en `VB`, Haly hizo un programa en `perl` y  hoy lo resolví con `python` (y después con `R`). Esto se encuentra documentado en los subdirectorios `ema/`, `mcr/` y `fmp/`, respectivamente.</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21">datos&lt;-<span class="kw">data.frame</span>(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)</a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="kw">rm</span>(pdb, nde, tde, ide, nom, tec, peh, con, rs1, rs2, gpo, doi)</a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co"># Cuando `R` crea el data.frame, escribe todo como factor</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co"># El número de entidades, el pH y la resolución</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co"># debe tratarse como número</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26">datos<span class="op">$</span>nde&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>nde)))</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">datos<span class="op">$</span>peh&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>peh)))</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">datos<span class="op">$</span>rs1&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>rs1)))</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">datos<span class="op">$</span>rs2&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>((datos<span class="op">$</span>rs2)))</a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co"># Verificamos los datos al graficar algunas variables:</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>peh)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;pH&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">1</span>, <span class="dv">11</span>) </a></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>rs1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Resolución (Å)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>)</a></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> datos, <span class="kw">aes</span>(<span class="dt">x=</span>nde)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Número de entidades&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>)</a></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Es lo mismo? Sí. La única diferencia es </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># que las barras están separadas</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#ggplot(data = datos, aes(x=nde)) + geom_bar() + labs(x=&quot;Número de entidades&quot;, y=&quot;Frecuencia&quot;)</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">df1&lt;-datos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st">  </span><span class="kw">add_count</span>(gpo, <span class="dt">name =</span> <span class="st">&quot;cta_gpo&quot;</span>)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">df2&lt;-df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">  </span><span class="kw">add_count</span>(tde, <span class="dt">name =</span> <span class="st">&quot;cta_tde&quot;</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">df3&lt;-datos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="st">  </span><span class="kw">count</span>(gpo, <span class="dt">name =</span> <span class="st">&quot;cta_gpo&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cta_gpo))</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">df4&lt;-datos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="st">  </span><span class="kw">count</span>(tde, <span class="dt">name =</span> <span class="st">&quot;cta_tde&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cta_tde))</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(gpo, cta_gpo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Grupo espacial&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</a></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-12-4.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">gpo_rar &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(cta_gpo <span class="op">&lt;=</span><span class="st"> </span><span class="dv">15</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> gpo_rar, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(gpo, cta_gpo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Grupo espacial&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Grupos espaciales con una frecuencia menor o igual a 15&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()<span class="co">#+ theme(axis.text.x = element_text(size = 12, angle = 45)) </span></a></code></pre></div>
<p><img src="arrozconleche_files/figure-html/unnamed-chunk-12-5.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Una tabla</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">tabla_gpos&lt;-<span class="kw">head</span>(df3, <span class="dt">n=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw">kable</span>(tabla_gpos) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width=</span>F)</a></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
gpo
</th>
<th style="text-align:right;">
cta_gpo
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P 21 21 21
</td>
<td style="text-align:right;">
58553
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21 1
</td>
<td style="text-align:right;">
40925
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 2 1
</td>
<td style="text-align:right;">
21183
</td>
</tr>
<tr>
<td style="text-align:left;">
C 2 2 21
</td>
<td style="text-align:right;">
12353
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 21 2
</td>
<td style="text-align:right;">
9612
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 21 2
</td>
<td style="text-align:right;">
8377
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1
</td>
<td style="text-align:right;">
8087
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 21 2
</td>
<td style="text-align:right;">
6933
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31 2 1
</td>
<td style="text-align:right;">
5678
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32 2 1
</td>
<td style="text-align:right;">
5497
</td>
</tr>
<tr>
<td style="text-align:left;">
I 2 2 2
</td>
<td style="text-align:right;">
4805
</td>
</tr>
<tr>
<td style="text-align:left;">
P 61 2 2
</td>
<td style="text-align:right;">
3107
</td>
</tr>
<tr>
<td style="text-align:left;">
P 65 2 2
</td>
<td style="text-align:right;">
2964
</td>
</tr>
<tr>
<td style="text-align:left;">
H 3 2
</td>
<td style="text-align:right;">
2778
</td>
</tr>
<tr>
<td style="text-align:left;">
H 3
</td>
<td style="text-align:right;">
2510
</td>
</tr>
<tr>
<td style="text-align:left;">
P 61
</td>
<td style="text-align:right;">
2319
</td>
</tr>
<tr>
<td style="text-align:left;">
P 65
</td>
<td style="text-align:right;">
2040
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4 2 2
</td>
<td style="text-align:right;">
1738
</td>
</tr>
<tr>
<td style="text-align:left;">
P 63
</td>
<td style="text-align:right;">
1474
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41
</td>
<td style="text-align:right;">
1246
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 21 21
</td>
<td style="text-align:right;">
1168
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32
</td>
<td style="text-align:right;">
1153
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31
</td>
<td style="text-align:right;">
1146
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43
</td>
<td style="text-align:right;">
1125
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41 2 2
</td>
<td style="text-align:right;">
1088
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 21 2
</td>
<td style="text-align:right;">
1046
</td>
</tr>
<tr>
<td style="text-align:left;">
P 63 2 2
</td>
<td style="text-align:right;">
1010
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4
</td>
<td style="text-align:right;">
987
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 3
</td>
<td style="text-align:right;">
948
</td>
</tr>
<tr>
<td style="text-align:left;">
I 2 3
</td>
<td style="text-align:right;">
797
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3 2 1
</td>
<td style="text-align:right;">
734
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 21 2
</td>
<td style="text-align:right;">
626
</td>
</tr>
<tr>
<td style="text-align:left;">
P 62 2 2
</td>
<td style="text-align:right;">
591
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 2 2
</td>
<td style="text-align:right;">
584
</td>
</tr>
<tr>
<td style="text-align:left;">
I 21 3
</td>
<td style="text-align:right;">
561
</td>
</tr>
<tr>
<td style="text-align:left;">
P 64 2 2
</td>
<td style="text-align:right;">
524
</td>
</tr>
<tr>
<td style="text-align:left;">
I 1 2 1
</td>
<td style="text-align:right;">
514
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 2 2
</td>
<td style="text-align:right;">
505
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41
</td>
<td style="text-align:right;">
484
</td>
</tr>
<tr>
<td style="text-align:left;">
I 21 21 21
</td>
<td style="text-align:right;">
466
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 2 21
</td>
<td style="text-align:right;">
465
</td>
</tr>
<tr>
<td style="text-align:left;">
C 2 2 2
</td>
<td style="text-align:right;">
450
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 2 1
</td>
<td style="text-align:right;">
437
</td>
</tr>
<tr>
<td style="text-align:left;">
P 64
</td>
<td style="text-align:right;">
398
</td>
</tr>
<tr>
<td style="text-align:left;">
P 6
</td>
<td style="text-align:right;">
388
</td>
</tr>
<tr>
<td style="text-align:left;">
P 62
</td>
<td style="text-align:right;">
363
</td>
</tr>
<tr>
<td style="text-align:left;">
F 4 3 2
</td>
<td style="text-align:right;">
322
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3
</td>
<td style="text-align:right;">
316
</td>
</tr>
<tr>
<td style="text-align:left;">
P 41 3 2
</td>
<td style="text-align:right;">
293
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 2 21
</td>
<td style="text-align:right;">
275
</td>
</tr>
<tr>
<td style="text-align:left;">
F 2 2 2
</td>
<td style="text-align:right;">
272
</td>
</tr>
<tr>
<td style="text-align:left;">
P 32 1 2
</td>
<td style="text-align:right;">
233
</td>
</tr>
<tr>
<td style="text-align:left;">
P 31 1 2
</td>
<td style="text-align:right;">
214
</td>
</tr>
<tr>
<td style="text-align:left;">
I 4 3 2
</td>
<td style="text-align:right;">
183
</td>
</tr>
<tr>
<td style="text-align:left;">
F 2 3
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:left;">
P 6 2 2
</td>
<td style="text-align:right;">
166
</td>
</tr>
<tr>
<td style="text-align:left;">
P 43 3 2
</td>
<td style="text-align:right;">
163
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4
</td>
<td style="text-align:right;">
158
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42
</td>
<td style="text-align:right;">
153
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41 3 2
</td>
<td style="text-align:right;">
128
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 2 2
</td>
<td style="text-align:right;">
119
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 3
</td>
<td style="text-align:right;">
116
</td>
</tr>
<tr>
<td style="text-align:left;">
F 41 3 2
</td>
<td style="text-align:right;">
102
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 3 2
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
P 4 2 2
</td>
<td style="text-align:right;">
76
</td>
</tr>
<tr>
<td style="text-align:left;">
P 42 3 2
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:left;">
P -1
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:left;">
B 1 1 2
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
P 3 1 2
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 2 2
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 1 21
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
I 1 21 1
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
R 3
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21/n 1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 2 2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
R 3 2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P 21 21 2 A
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 21 1
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
P 1 21/c 1
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
C 1 2/c 1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
I 41/a
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
P 2 21 2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
A 1 2 1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
P b c a
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
C 4 21 2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
F 4 2 2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
H -3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
P n n a
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
A 1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B 2 21 2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
I -4 2 d
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
I -4 c 2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P -3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P c a b
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Otra tabla</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">tabla_tdes&lt;-<span class="kw">head</span>(df4, <span class="dt">n=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">kable</span>(tabla_tdes) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width=</span>F)</a></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
tde
</th>
<th style="text-align:right;">
cta_tde
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
polypeptide(L)
</td>
<td style="text-align:right;">
208248
</td>
</tr>
<tr>
<td style="text-align:left;">
polydeoxyribonucleotide
</td>
<td style="text-align:right;">
10845
</td>
</tr>
<tr>
<td style="text-align:left;">
polyribonucleotide
</td>
<td style="text-align:right;">
5268
</td>
</tr>
<tr>
<td style="text-align:left;">
polydeoxyribonucleotide/polyribonucleotide hybrid
</td>
<td style="text-align:right;">
171
</td>
</tr>
<tr>
<td style="text-align:left;">
polypeptide(D)
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:left;">
peptide nucleic acid
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">rm</span>(todo2)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co"># Guarda los data frames</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">write_excel_csv</span>(df2, <span class="st">&quot;/run/media/murphy/lolita/doctorado/extract/results.csv&quot;</span>)</a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dependencias.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="limpieza-de-datos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["arrozconleche.pdf", "arrozconleche.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
